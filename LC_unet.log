----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1        [-1, 128, 160, 160]          38,016
            Conv2d-2        [-1, 128, 160, 160]          38,016
            Conv2d-3        [-1, 128, 160, 160]          38,016
            Conv2d-4        [-1, 128, 160, 160]          38,016
            Conv2d-5        [-1, 128, 160, 160]          38,016
            Conv2d-6        [-1, 128, 160, 160]          38,016
            Conv2d-7        [-1, 128, 160, 160]          38,016
            Conv2d-8        [-1, 128, 160, 160]          38,016
            Conv2d-9        [-1, 128, 160, 160]          38,016
           Conv2d-10        [-1, 128, 160, 160]          38,016
           Conv2d-11        [-1, 128, 160, 160]          38,016
           Conv2d-12        [-1, 128, 160, 160]          38,016
           Conv2d-13        [-1, 128, 160, 160]          38,016
           Conv2d-14        [-1, 128, 160, 160]          38,016
           Conv2d-15        [-1, 128, 160, 160]          38,016
           Conv2d-16        [-1, 128, 160, 160]          38,016
           Conv2d-17        [-1, 128, 160, 160]          38,016
           Conv2d-18        [-1, 128, 160, 160]          38,016
           Conv2d-19        [-1, 128, 160, 160]          38,016
           Conv2d-20        [-1, 128, 160, 160]          38,016
           Conv2d-21        [-1, 128, 160, 160]          38,016
           Conv2d-22        [-1, 128, 160, 160]          38,016
           Conv2d-23        [-1, 128, 160, 160]          38,016
           Conv2d-24        [-1, 128, 160, 160]          38,016
           Conv2d-25        [-1, 128, 160, 160]          38,016
           Conv2d-26        [-1, 128, 160, 160]          38,016
           Conv2d-27        [-1, 128, 160, 160]          38,016
           Conv2d-28        [-1, 128, 160, 160]          38,016
           Conv2d-29        [-1, 128, 160, 160]          38,016
           Conv2d-30        [-1, 128, 160, 160]          38,016
           Conv2d-31        [-1, 128, 160, 160]          38,016
           Conv2d-32        [-1, 128, 160, 160]          38,016
           Conv2d-33        [-1, 128, 160, 160]          38,016
           Conv2d-34        [-1, 128, 160, 160]          38,016
           Conv2d-35        [-1, 128, 160, 160]          38,016
           Conv2d-36        [-1, 128, 160, 160]          38,016
           Conv2d-37        [-1, 128, 160, 160]          38,016
           Conv2d-38        [-1, 128, 160, 160]          38,016
           Conv2d-39        [-1, 128, 160, 160]          38,016
           Conv2d-40        [-1, 128, 160, 160]          38,016
           Conv2d-41        [-1, 128, 160, 160]          38,016
           Conv2d-42        [-1, 128, 160, 160]          38,016
           Conv2d-43        [-1, 128, 160, 160]          38,016
           Conv2d-44        [-1, 128, 160, 160]          38,016
           Conv2d-45        [-1, 128, 160, 160]          38,016
           Conv2d-46        [-1, 128, 160, 160]          38,016
           Conv2d-47        [-1, 128, 160, 160]          38,016
           Conv2d-48        [-1, 128, 160, 160]          38,016
           Conv2d-49        [-1, 128, 160, 160]          38,016
           Conv2d-50        [-1, 128, 160, 160]          38,016
           Conv2d-51        [-1, 128, 160, 160]          38,016
           Conv2d-52        [-1, 128, 160, 160]          38,016
           Conv2d-53        [-1, 128, 160, 160]          38,016
           Conv2d-54        [-1, 128, 160, 160]          38,016
           Conv2d-55        [-1, 128, 160, 160]          38,016
           Conv2d-56        [-1, 128, 160, 160]          38,016
           Conv2d-57        [-1, 128, 160, 160]          38,016
           Conv2d-58        [-1, 128, 160, 160]          38,016
           Conv2d-59        [-1, 128, 160, 160]          38,016
           Conv2d-60        [-1, 128, 160, 160]          38,016
           Conv2d-61        [-1, 128, 160, 160]          38,016
           Conv2d-62        [-1, 128, 160, 160]          38,016
           Conv2d-63        [-1, 128, 160, 160]          38,016
           Conv2d-64        [-1, 128, 160, 160]          38,016
           Conv2d-65        [-1, 128, 160, 160]          38,016
           Conv2d-66        [-1, 128, 160, 160]          38,016
           Conv2d-67        [-1, 128, 160, 160]          38,016
           Conv2d-68        [-1, 128, 160, 160]          38,016
           Conv2d-69        [-1, 128, 160, 160]          38,016
           Conv2d-70        [-1, 128, 160, 160]          38,016
           Conv2d-71        [-1, 128, 160, 160]          38,016
           Conv2d-72        [-1, 128, 160, 160]          38,016
           Conv2d-73        [-1, 128, 160, 160]          38,016
           Conv2d-74        [-1, 128, 160, 160]          38,016
           Conv2d-75        [-1, 128, 160, 160]          38,016
           Conv2d-76        [-1, 128, 160, 160]          38,016
           Conv2d-77        [-1, 128, 160, 160]          38,016
           Conv2d-78        [-1, 128, 160, 160]          38,016
           Conv2d-79        [-1, 128, 160, 160]          38,016
           Conv2d-80        [-1, 128, 160, 160]          38,016
         ConvLSTM-81     [-1, 32, 80, 160, 160]               0
        MaxPool3d-82       [-1, 32, 40, 80, 80]               0
       Downsample-83       [-1, 32, 40, 80, 80]               0
           Conv2d-84          [-1, 256, 80, 80]         221,184
           Conv2d-85          [-1, 256, 80, 80]         221,184
           Conv2d-86          [-1, 256, 80, 80]         221,184
           Conv2d-87          [-1, 256, 80, 80]         221,184
           Conv2d-88          [-1, 256, 80, 80]         221,184
           Conv2d-89          [-1, 256, 80, 80]         221,184
           Conv2d-90          [-1, 256, 80, 80]         221,184
           Conv2d-91          [-1, 256, 80, 80]         221,184
           Conv2d-92          [-1, 256, 80, 80]         221,184
           Conv2d-93          [-1, 256, 80, 80]         221,184
           Conv2d-94          [-1, 256, 80, 80]         221,184
           Conv2d-95          [-1, 256, 80, 80]         221,184
           Conv2d-96          [-1, 256, 80, 80]         221,184
           Conv2d-97          [-1, 256, 80, 80]         221,184
           Conv2d-98          [-1, 256, 80, 80]         221,184
           Conv2d-99          [-1, 256, 80, 80]         221,184
          Conv2d-100          [-1, 256, 80, 80]         221,184
          Conv2d-101          [-1, 256, 80, 80]         221,184
          Conv2d-102          [-1, 256, 80, 80]         221,184
          Conv2d-103          [-1, 256, 80, 80]         221,184
          Conv2d-104          [-1, 256, 80, 80]         221,184
          Conv2d-105          [-1, 256, 80, 80]         221,184
          Conv2d-106          [-1, 256, 80, 80]         221,184
          Conv2d-107          [-1, 256, 80, 80]         221,184
          Conv2d-108          [-1, 256, 80, 80]         221,184
          Conv2d-109          [-1, 256, 80, 80]         221,184
          Conv2d-110          [-1, 256, 80, 80]         221,184
          Conv2d-111          [-1, 256, 80, 80]         221,184
          Conv2d-112          [-1, 256, 80, 80]         221,184
          Conv2d-113          [-1, 256, 80, 80]         221,184
          Conv2d-114          [-1, 256, 80, 80]         221,184
          Conv2d-115          [-1, 256, 80, 80]         221,184
          Conv2d-116          [-1, 256, 80, 80]         221,184
          Conv2d-117          [-1, 256, 80, 80]         221,184
          Conv2d-118          [-1, 256, 80, 80]         221,184
          Conv2d-119          [-1, 256, 80, 80]         221,184
          Conv2d-120          [-1, 256, 80, 80]         221,184
          Conv2d-121          [-1, 256, 80, 80]         221,184
          Conv2d-122          [-1, 256, 80, 80]         221,184
          Conv2d-123          [-1, 256, 80, 80]         221,184
        ConvLSTM-124       [-1, 64, 40, 80, 80]               0
       MaxPool3d-125       [-1, 64, 20, 40, 40]               0
      Downsample-126       [-1, 64, 20, 40, 40]               0
          Conv2d-127          [-1, 512, 40, 40]         884,736
          Conv2d-128          [-1, 512, 40, 40]         884,736
          Conv2d-129          [-1, 512, 40, 40]         884,736
          Conv2d-130          [-1, 512, 40, 40]         884,736
          Conv2d-131          [-1, 512, 40, 40]         884,736
          Conv2d-132          [-1, 512, 40, 40]         884,736
          Conv2d-133          [-1, 512, 40, 40]         884,736
          Conv2d-134          [-1, 512, 40, 40]         884,736
          Conv2d-135          [-1, 512, 40, 40]         884,736
          Conv2d-136          [-1, 512, 40, 40]         884,736
          Conv2d-137          [-1, 512, 40, 40]         884,736
          Conv2d-138          [-1, 512, 40, 40]         884,736
          Conv2d-139          [-1, 512, 40, 40]         884,736
          Conv2d-140          [-1, 512, 40, 40]         884,736
          Conv2d-141          [-1, 512, 40, 40]         884,736
          Conv2d-142          [-1, 512, 40, 40]         884,736
          Conv2d-143          [-1, 512, 40, 40]         884,736
          Conv2d-144          [-1, 512, 40, 40]         884,736
          Conv2d-145          [-1, 512, 40, 40]         884,736
          Conv2d-146          [-1, 512, 40, 40]         884,736
        ConvLSTM-147      [-1, 128, 20, 40, 40]               0
       MaxPool3d-148      [-1, 128, 10, 20, 20]               0
      Downsample-149      [-1, 128, 10, 20, 20]               0
          Conv2d-150         [-1, 1024, 20, 20]       3,538,944
          Conv2d-151         [-1, 1024, 20, 20]       3,538,944
          Conv2d-152         [-1, 1024, 20, 20]       3,538,944
          Conv2d-153         [-1, 1024, 20, 20]       3,538,944
          Conv2d-154         [-1, 1024, 20, 20]       3,538,944
          Conv2d-155         [-1, 1024, 20, 20]       3,538,944
          Conv2d-156         [-1, 1024, 20, 20]       3,538,944
          Conv2d-157         [-1, 1024, 20, 20]       3,538,944
          Conv2d-158         [-1, 1024, 20, 20]       3,538,944
          Conv2d-159         [-1, 1024, 20, 20]       3,538,944
        ConvLSTM-160      [-1, 256, 10, 20, 20]               0
       MaxPool3d-161       [-1, 256, 5, 10, 10]               0
      Downsample-162       [-1, 256, 5, 10, 10]               0
          Conv2d-163         [-1, 2048, 10, 10]      14,155,776
          Conv2d-164         [-1, 2048, 10, 10]      14,155,776
          Conv2d-165         [-1, 2048, 10, 10]      14,155,776
          Conv2d-166         [-1, 2048, 10, 10]      14,155,776
          Conv2d-167         [-1, 2048, 10, 10]      14,155,776
        ConvLSTM-168       [-1, 512, 5, 10, 10]               0
          Conv3d-169      [-1, 256, 10, 20, 20]       3,539,200
        Upsample-170      [-1, 256, 10, 20, 20]               0
          Conv3d-171      [-1, 256, 10, 20, 20]       3,539,200
     BatchNorm3d-172      [-1, 256, 10, 20, 20]             512
            ReLU-173      [-1, 256, 10, 20, 20]               0
        CNNLayer-174      [-1, 256, 10, 20, 20]               0
          Conv3d-175      [-1, 128, 20, 40, 40]         884,864
        Upsample-176      [-1, 128, 20, 40, 40]               0
          Conv3d-177      [-1, 128, 20, 40, 40]         884,864
     BatchNorm3d-178      [-1, 128, 20, 40, 40]             256
            ReLU-179      [-1, 128, 20, 40, 40]               0
        CNNLayer-180      [-1, 128, 20, 40, 40]               0
          Conv3d-181       [-1, 64, 40, 80, 80]         221,248
        Upsample-182       [-1, 64, 40, 80, 80]               0
          Conv3d-183       [-1, 64, 40, 80, 80]         221,248
     BatchNorm3d-184       [-1, 64, 40, 80, 80]             128
            ReLU-185       [-1, 64, 40, 80, 80]               0
        CNNLayer-186       [-1, 64, 40, 80, 80]               0
          Conv3d-187     [-1, 32, 80, 160, 160]          55,328
        Upsample-188     [-1, 32, 80, 160, 160]               0
          Conv3d-189     [-1, 32, 80, 160, 160]          55,328
     BatchNorm3d-190     [-1, 32, 80, 160, 160]              64
            ReLU-191     [-1, 32, 80, 160, 160]               0
        CNNLayer-192     [-1, 32, 80, 160, 160]               0
          Conv3d-193      [-1, 3, 80, 160, 160]           2,595
================================================================
Total params: 145,156,515
Trainable params: 145,156,515
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 7.81
Forward/backward pass size (MB): 7527.34
Params size (MB): 553.73
Estimated Total Size (MB): 8088.88
----------------------------------------------------------------
/home/vince/nnunet/lib/python3.7/site-packages/torch/nn/functional.py:3613: UserWarning: Default upsampling behavior when mode=trilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  "See the documentation of nn.Upsample for details.".format(mode)
Unsupported operator aten::sigmoid encountered 465 time(s)
Unsupported operator aten::mul encountered 465 time(s)
Unsupported operator aten::add encountered 155 time(s)
Unsupported operator aten::tanh encountered 155 time(s)
Unsupported operator aten::max_pool3d encountered 4 time(s)
Unsupported operator aten::upsample_trilinear3d encountered 4 time(s)
flops_all 1228883968000 flops_operator Counter({'conv': 1228013568000, 'batch_norm': 870400000}) flops_module {'': Counter({'conv': 1228013568000, 'batch_norm': 870400000}), 'convLSTM1': Counter({'conv': 155713536000}), 'convLSTM1.conv': Counter({'conv': 155713536000}), 'convLSTM1.conv.0': Counter({'conv': 155713536000}), 'Downsample1': Counter(), 'Downsample1.layer': Counter(), 'convLSTM2': Counter({'conv': 113246208000}), 'convLSTM2.conv': Counter({'conv': 113246208000}), 'convLSTM2.conv.0': Counter({'conv': 113246208000}), 'Downsample2': Counter(), 'Downsample2.layer': Counter(), 'convLSTM3': Counter({'conv': 56623104000}), 'convLSTM3.conv': Counter({'conv': 56623104000}), 'convLSTM3.conv.0': Counter({'conv': 56623104000}), 'Downsample3': Counter(), 'Downsample3.layer': Counter(), 'convLSTM4': Counter({'conv': 28311552000}), 'convLSTM4.conv': Counter({'conv': 28311552000}), 'convLSTM4.conv.0': Counter({'conv': 28311552000}), 'Downsample4': Counter(), 'Downsample4.layer': Counter(), 'convLSTM5': Counter({'conv': 14155776000}), 'convLSTM5.conv': Counter({'conv': 14155776000}), 'convLSTM5.conv.0': Counter({'conv': 14155776000}), 'Upsample1': Counter({'conv': 28311552000}), 'Upsample1.C': Counter({'conv': 28311552000}), 'Conv6': Counter({'conv': 28311552000, 'batch_norm': 10240000}), 'Conv6.conv': Counter({'conv': 28311552000}), 'Conv6.norm': Counter({'batch_norm': 10240000}), 'Conv6.relu': Counter(), 'Upsample2': Counter({'conv': 56623104000}), 'Upsample2.C': Counter({'conv': 56623104000}), 'Conv7': Counter({'conv': 56623104000, 'batch_norm': 40960000}), 'Conv7.conv': Counter({'conv': 56623104000}), 'Conv7.norm': Counter({'batch_norm': 40960000}), 'Conv7.relu': Counter(), 'Upsample3': Counter({'conv': 113246208000}), 'Upsample3.C': Counter({'conv': 113246208000}), 'Conv8': Counter({'conv': 113246208000, 'batch_norm': 163840000}), 'Conv8.conv': Counter({'conv': 113246208000}), 'Conv8.norm': Counter({'batch_norm': 163840000}), 'Conv8.relu': Counter(), 'Upsample4': Counter({'conv': 226492416000}), 'Upsample4.C': Counter({'conv': 226492416000}), 'Conv9': Counter({'conv': 226492416000, 'batch_norm': 655360000}), 'Conv9.conv': Counter({'conv': 226492416000}), 'Conv9.norm': Counter({'batch_norm': 655360000}), 'Conv9.relu': Counter(), 'final': Counter({'conv': 10616832000})}
